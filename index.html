<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>お願いドライブ礼法</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <style>
    body { font-family: Arial, "メイリオ", Meiryo, sans-serif; background: #f7f5fa; margin: 0; }
    header { background: #49326b; color: #fff; padding: 1.2em 0; text-align: center; }
    .container { max-width: 420px; margin: auto; background: #fff; border-radius: 12px; box-shadow: 0 3px 10px #ccc; padding: 2em; margin-top: 2em; }
    h2 { margin-top: 0;}
    label { display: block; margin-top: 1.3em; font-weight: bold;}
    input, select { width: 100%; padding: .7em; border-radius: 8px; border: 1px solid #bcb7d6; margin-top: .4em;}
    .btn { background: #7957d5; color: #fff; border:none; border-radius: 8px; padding: .8em; text-align:center; width:100%; font-size:1.1em; cursor:pointer; margin-top:1.7em; }
    .btn:active { background: #49326b;}
    .result {background: #f2edfa; margin-top: 2em; padding: 1em; border-radius:10px;}
    .result strong { color: #7957d5;}
    .gift {border: 1px solid #dac0ff; padding:.7em 1em; border-radius:7px; margin-top: 1em;}
    .small {font-size: 0.95em; color:#665;}
    .footer { text-align: center; color:#999; font-size:0.92em; margin-top:3em;}
  </style>
</head>
<body>
<header>
  <h1>お願いドライブ礼法</h1>
  <div>透明なコスト分担で、気持ちよく運転依頼</div>
</header>
<div class="container">
  <h2>乗車依頼フォーム</h2>
  <form id="driveForm">
    <label>
      出発地
      <input type="text" id="start" placeholder="例：東京駅" required>
    </label>
    <label>
      目的地
      <input type="text" id="end" placeholder="例：伊豆温泉" required>
    </label>
    <label>
      乗車人数（運転者含む）
      <input type="number" id="people" min="2" value="2" required>
    </label>
    <label>
      車種
      <select id="carType">
        <option value="compact">コンパクト（燃費15km/L）</option>
        <option value="sedan">セダン（燃費12km/L）</option>
        <option value="minivan">ミニバン（燃費9km/L）</option>
      </select>
    </label>
    <label>
      高速区間（km）
      <input type="number" id="highwayKm" min="0" value="50">
      <span class="small">※ざっくり目安でOK</span>
    </label>
    <label>
      駐車料金（円・合計）
      <input type="number" id="parking" min="0" value="1000">
    </label>
    <label>
      想定運転時間（時間）
      <input type="number" id="driveTime" min="0.5" step="0.5" value="2.5">
    </label>
    <button type="submit" class="btn">分担を試算する</button>
  </form>


  <div id="resultBlock" class="result" style="display:none;">
    <h3>試算・メッセージ</h3>
    <div id="shareResult"></div>
    <div id="messageResult" style="margin-top:1.5em;line-height:1.6;"></div>
    <div style="margin-top:1.2em;">
      <a id="paypayLink" target="_blank" class="btn" style="background:#20bb69;">PayPayで送金する</a>
    </div>
    <div class="gift">
      <strong>特別ギフト提案</strong><br>
      運転への感謝をギフトで！<br>
      <a href="https://giftee.com/" target="_blank">コーヒー（コンビニギフト）</a> /
      <a href="https://yado.knt.co.jp/" target="_blank">日帰り温泉割引</a> /
      <a href="https://tabiiro.jp/gift/" target="_blank">ご当地グルメ</a>
    </div>
  </div>
</div>
<div class="footer">
  一言価値: 迷惑かけたくない不安を、<br>透明なコスト分担と礼の見える化で解消。<br>
  &copy; ドライブ礼法 MVP案
</div>

<script>
function yen(x){ return '¥'+(Math.round(x)).toLocaleString(); }
document.getElementById("driveForm").onsubmit = function(e){
  e.preventDefault();
  // 入力値取得
  const start = document.getElementById("start").value.trim();
  const end = document.getElementById("end").value.trim();
  let people = parseInt(document.getElementById("people").value);
  const carType = document.getElementById("carType").value;
  const highwayKm = parseFloat(document.getElementById("highwayKm").value);
  const parking = parseInt(document.getElementById("parking").value);
  const driveTime = parseFloat(document.getElementById("driveTime").value);

  // デフォルト距離計算（仮:高速区間*1.2で全体距離と推定）
  const totalKm = highwayKm*1.2;

  // 燃費↓
  let fuelEff = 15;
  if(carType==="sedan") fuelEff = 12;
  if(carType==="minivan") fuelEff = 9;

  // 概算
  const fuelCost = totalKm/fuelEff*170; // ガソリン170円/L仮定
  const highwayCost = highwayKm*25;     // 高速1kmあたり25円目安
  // 交通費合計
  const totalCost = fuelCost+highwayCost+parking;
  const shareCost = totalCost/people; //人数割り

  // メッセージ生成
  const driverName = "（友人名）"; // MVPなので未入力
  let msg =
    `こんにちは${driverName}！\n`;
  msg += `${start}→${end}にご一緒したく、運転お願いできますか？\n\n`;
  msg += `交通コストは計算し、人数分でフェアに分担します。\n`;
  msg += `\n【合計費用の見積】\n`
    + `燃料: ${yen(fuelCost)}、高速: ${yen(highwayCost)}、駐車: ${yen(parking)}\n`
    + `（人数${people}人、1人あたり: <strong>${yen(shareCost)}</strong>）\n\n`;
  msg += `\n【休憩や立ち寄りについて】\n`
    + `・運転者優先で目的地中、希望あれば遠慮なく！\n`
    + `・運転時間${driveTime}時間なので休憩は最低1回入れたいです。\n\n`;
  msg += `\n【お礼・ギフト】\n`
    + `ご負担に感謝し、ドライバー向けのギフトも検討中です。`;
  msg += `\n\nPayPayで即送金します！`;

  // 送金リンク仮生成（実際はPayPay API）
  const money = Math.round(shareCost);
  const payLink = `https://paypay.ne.jp/send/?amount=${money}&message=ドライブ礼法で交通費送金`;

  // 表示
  document.getElementById("resultBlock").style.display = "";
  document.getElementById("shareResult").innerHTML =
    `<strong>概算分担額</strong>（1人あたり）：<big style="font-size:1.3em;color:#1c8757;">${yen(shareCost)}</big> <br>
    <span class="small">総費用=${yen(totalCost)}（燃料${yen(fuelCost)} + 高速${yen(highwayCost)} + 駐車${yen(parking)}）</span>
    `;

  document.getElementById("messageResult").innerHTML =
    msg.replace(/\n/g, "<br>");
  document.getElementById("paypayLink").href = payLink;

}
</script>
</body>
</html>
